<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Extending Unitful ¬∑ Unitful.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Unitful.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../highlights/">Highlighted features</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../newunits/">Defining new units</a></li><li><a class="tocitem" href="../conversion/">Conversion/promotion</a></li><li><a class="tocitem" href="../manipulations/">Manipulating units</a></li><li><a class="tocitem" href="../display/">How units are displayed</a></li><li><a class="tocitem" href="../logarithm/">Logarithmic scales</a></li><li><a class="tocitem" href="../temperature/">Temperature scales</a></li><li><a class="tocitem" href="../dates/">Interoperability with <code>Dates</code></a></li><li class="is-active"><a class="tocitem" href>Extending Unitful</a><ul class="internal"><li><a class="tocitem" href="#Making-your-own-units-package-1"><span>Making your own units package</span></a></li><li><a class="tocitem" href="#Some-limitations-1"><span>Some limitations</span></a></li><li><a class="tocitem" href="#Archaic-or-fictitious-unit-systems-1"><span>Archaic or fictitious unit systems</span></a></li></ul></li><li><a class="tocitem" href="../trouble/">Troubleshooting</a></li><li><a class="tocitem" href="../LICENSE/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Extending Unitful</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Extending Unitful</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PainterQubits/Unitful.jl/blob/master/docs/src/extending.md" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Extending-Unitful-1"><a class="docs-heading-anchor" href="#Extending-Unitful-1">Extending Unitful</a><a class="docs-heading-anchor-permalink" href="#Extending-Unitful-1" title="Permalink"></a></h1><h2 id="Making-your-own-units-package-1"><a class="docs-heading-anchor" href="#Making-your-own-units-package-1">Making your own units package</a><a class="docs-heading-anchor-permalink" href="#Making-your-own-units-package-1" title="Permalink"></a></h2><p>New units or dimensions can be defined from the Julia REPL or from within other packages. To avoid duplication of code and effort, it is advised to put new unit definitions into a Julia package that is then published for others to use. For an example of how to do this, examine the code in <a href="https://github.com/PainterQubits/UnitfulUS.jl"><code>UnitfulUS.jl</code></a>, which defines U.S. customary units. It&#39;s actually very easy! Just make sure you read all of the cautionary notes on this page. If you make a units package for Unitful, please submit a pull request so that I can provide a link from Unitful&#39;s README!</p><h2 id="Some-limitations-1"><a class="docs-heading-anchor" href="#Some-limitations-1">Some limitations</a><a class="docs-heading-anchor-permalink" href="#Some-limitations-1" title="Permalink"></a></h2><h3 id="Precompilation-1"><a class="docs-heading-anchor" href="#Precompilation-1">Precompilation</a><a class="docs-heading-anchor-permalink" href="#Precompilation-1" title="Permalink"></a></h3><p>When creating new units in a precompiled package that need to persist into run-time (usually true), it is important that the following make it into your code:</p><pre><code class="language-julia">function __init__()
    Unitful.register(YourModule)
end</code></pre><p>By calling <a href="../manipulations/#Unitful.register"><code>Unitful.register</code></a> in your <code>__init__</code> function, you tell Unitful about some internal data required to make Unit conversions work and also make your units accessible to Unitful&#39;s <a href="../manipulations/#Unitful.@u_str"><code>@u_str</code></a> macro. Your unit symbols should ideally be distinctive to avoid colliding with symbols defined in other packages or in Unitful. If there is a collision, the <a href="../manipulations/#Unitful.@u_str"><code>@u_str</code></a> macro will still work, but it will use the unit found in whichever package was registered most recently, and it will emit a warning every time.</p><p>If you use the <code>@u_str</code> macro with the units defined in your package, you&#39;ll also need to call <code>Unitful.register()</code> at the top level of your package at compile time.</p><p>In the unlikely case that you&#39;ve used <code>@dimension</code>, you will also need the following incantation:</p><pre><code class="language-julia">const localpromotion = Unitful.promotion
function __init__()
    Unitful.register(YourModule)
    merge!(Unitful.promotion, localpromotion)
end</code></pre><p>The definition of <code>localpromotion</code> must happen <em>after all new units (dimensions) have been defined</em>.</p><h3 id="Type-uniqueness-1"><a class="docs-heading-anchor" href="#Type-uniqueness-1">Type uniqueness</a><a class="docs-heading-anchor-permalink" href="#Type-uniqueness-1" title="Permalink"></a></h3><p>Currently, when the <a href="../newunits/#Unitful.@dimension"><code>@dimension</code></a>, <a href="../newunits/#Unitful.@derived_dimension"><code>@derived_dimension</code></a>, <a href="../newunits/#Unitful.@refunit"><code>@refunit</code></a>, or <a href="../newunits/#Unitful.@unit"><code>@unit</code></a> macros are used, some unique symbols must be provided which are used to differentiate types in dispatch. These are typically the names of dimensions or units (e.g. <code>Length</code>, <code>Meter</code>, etc.) One problem that could occur is that if multiple units or dimensions are defined with the same name, then they will be indistinguishable in dispatch and errors will result.</p><p>I don&#39;t expect a flood of units packages to come out, so probably the likelihood of name collision is pretty small. When defining units yourself, do take care to use unique symbols, perhaps with the aid of <code>Base.gensym()</code> if creating units at runtime. When making packages, look and see what symbols are used by existing units packages to avoid trouble.</p><h2 id="Archaic-or-fictitious-unit-systems-1"><a class="docs-heading-anchor" href="#Archaic-or-fictitious-unit-systems-1">Archaic or fictitious unit systems</a><a class="docs-heading-anchor-permalink" href="#Archaic-or-fictitious-unit-systems-1" title="Permalink"></a></h2><p>In the rare event that you want to define physical units which are not convertible to SI units, you need to do a bit of extra work. To be clear, such a conversion should always exist, in principle. One can imagine, however, archaic or fictitious unit systems for which a precise conversion to SI units is unknown. For example, a <a href="https://en.wikipedia.org/wiki/Cullishigay">cullishigay</a> is one-third of a mudi, but only <em>approximately</em> 1.25 imperial bushels. There may be cases where you don&#39;t even have an approximate conversion to imperial bushels. At such a time, you may feel uncomfortable specifying the &quot;base unit&quot; of this hypothetical unit system in terms of an SI quantity, and may want to explicitly forbid any attempt to convert to SI units.</p><p>One can achieve this by defining new dimensions with the <a href="../newunits/#Unitful.@dimension"><code>@dimension</code></a> or <a href="../newunits/#Unitful.@derived_dimension"><code>@derived_dimension</code></a> macros. The trick is to define dimensions that display suggestively like physical dimensions, like <code>ùêã*</code>, <code>ùêì*</code> etc., but are distinct as far as Julia&#39;s type system is concerned. Then, you can use <a href="../newunits/#Unitful.@refunit"><code>@refunit</code></a> to base units for these new dimensions without reference to SI. The result will be that attempted conversion between the hypothetical unit system and SI will fail with a <code>DimensionError</code>, so be sure you provide some hints in how your new dimensions are displayed to avoid confusing users. It would be confusing to throw a <code>DimensionError</code> when attempting to convert between lengths which are incompatible in the sense of the previous paragraph, when both lengths display their dimension as <code>ùêã</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dates/">¬´ Interoperability with <code>Dates</code></a><a class="docs-footer-nextpage" href="../trouble/">Troubleshooting ¬ª</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 4 June 2021 15:47">Friday 4 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
